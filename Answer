
یک پروژه شامل یک کلاس
مدیریت منابع به درستی از dispose و gc استفاده نمیکنه
هدف اصلا مدیریت منابع و اطمینان از ازدسازس حافظه و منابع خارجی
begooo
class program{
    stataic void main(string[] args){
        for (int i=0;i<1000;i++){
            var resource=new ResourceHolder();
            resource.DoWork();
        }
        GC.Collect();
        gc.WaitForPendingFinalizer();
        Console.Writeline("Finish");
    }
}Ma Amadeim :)

garbage collector .net
مدیریت حافظه و منابع درست نیست
اجرای مکرر memoryleak میخوره
مطمئن شم dispose pattern درست انجام شده
استفاده مناسب از  using
رعایت اصول Garbage colectoin
------------------------------ 
1.

using System;

class Program
{
    static void Main(string[] args)
    {
        for (int i = 0; i < 1000; i++)
        {
            using (var resource = new ResourceHolder())
            {
                resource.DoWork();
            } // Dispose خودکار اینجا اجرا میشه
        }

        Console.WriteLine("Finish");
    }
}

public class ResourceHolder : IDisposable
{
    private bool _disposed;
    // فرض محتوای unmanaged
    // private SafeHandle _safeHandle = new SafeFileHandle(...);

    public void DoWork()
    {
        if (_disposed) 
            throw new ObjectDisposedException(nameof(ResourceHolder));
        
        // عملیات...
    }

    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this); // نیاز به finalize بعد dispose نیست
    }

    protected virtual void Dispose(bool disposing)
    {
        if (!_disposed)
        {
            if (disposing)
            {
                // آزادسازی منابع managed
                // _safeHandle?.Dispose();
                // سایر فیلدهای IDisposable
            }

           
            _disposed = true;
        }
    }

    ~ResourceHolder()
    {
        Dispose(false); 
    }
}

------------------------------------------
