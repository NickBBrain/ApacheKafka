


چالش portability
این پروژه باید قابلیت اجرا روی چند دیتابیس را داشته باشه
الان مدلیه که وابستگی مستقیم به یک دیتابیس داره و امکان جابجای بین دیتابیس ها بدون تغییر کد نیست
هدف انتزاع دسترسی به db و برطرف کردن وابستگی به یک db خاض
hint
سعی کنید وابستگی به یک provider خاص رو حذف کنین و از مکانیزم قابل پیکربندی برای تعیین provider و connectionString
استفاده کنین
کش نداریم
ابتدا باید پکیج data.sqlClient برای sqlClientmanagedDataAccess برای oracle نصب بشن
سپس برنامه با دو ارگومان اجرا کنین1.نام provider مثلا system.data.sqlClient
2.connectionString مناسب دیتابیس:
dotnet run system.data.sqlClient "DataSource=localhost ...."

class Program
    {
        static void Main(string[] args)
        {
           var connectionString="Server=localhost....";
           using(var connection=new sqlConnection(connectionString)){

connection.Open();
car command=command.CreateCommand();
command.CommandText="select top 1 name from users";
var reader=command.ExecuteReader();
while(reader.Read()){

    console.writeline(reader.GetString(0));
}

           }
        }
    }
--------------------------------------------

using System;
using System.Data;
using System.Data.Common;

class Program
{
    static void Main(string[] args)
    {
        if (args.Length < 2)
        {
            Console.WriteLine("Usage: dotnet run <providerName> <connectionString>");
            return;
        }

        string providerName = args[0];       // مثل "System.Data.SqlClient" یا "Oracle.ManagedDataAccess.Client"
        string connectionString = args[1];   // رشته اتصال دیتابیس

        try
        {
            // ساخت DbProviderFactory بر اساس providerName
            var factory = DbProviderFactories.GetFactory(providerName);

            using var connection = factory.CreateConnection();
            if (connection == null)
            {
                Console.WriteLine("Failed to create a connection object.");
                return;
            }

            connection.ConnectionString = connectionString;
            connection.Open();

            using var command = connection.CreateCommand();
            command.CommandText = "SELECT TOP 1 Name FROM Users"; // برای Oracle باید معادلش بنویسی، مثلا: "SELECT Name FROM Users WHERE ROWNUM = 1"

            using var reader = command.ExecuteReader();
            while (reader.Read())
            {
                Console.WriteLine(reader.GetString(0));
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Database error: {ex.Message}");
        }
    }
}

